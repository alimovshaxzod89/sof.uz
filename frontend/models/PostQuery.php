<?php

namespace frontend\models;

use common\components\Config;
use yii\helpers\ArrayHelper;
use yii\mongodb\ActiveQuery;

class PostQuery extends ActiveQuery
{
    public function active($fields = [])
    {
        $lang = Config::getLanguageCode();

        return $this->select(
            ArrayHelper::merge([
                'title',
                '_categories',
                "_translations.title_$lang",
                "_translations.info_$lang",
                'slug',
                'short_id',
                'is_main',
                'status',
                'image',
                'published_on',
                'views',
                'views_l3d',
                'views_l7d',
                'is_ad',
                '_author',
                '_author_post',
            ], $fields))
            ->andFilterWhere(['status' => PostProvider::STATUS_PUBLISHED]);
    }

    /**
     * @param null $db
     * @return PostProvider[]|array|\yii\mongodb\ActiveRecord
     */
    public function all($db = null)
    {
        return parent::all($db); // TODO: Change the autogenerated stub
    }

    /**
     * @param null $db
     * @return PostProvider|array|null|\yii\mongodb\ActiveRecord
     */
    public function one($db = null)
    {
        return parent::one($db); // TODO: Change the autogenerated stub
    }
}